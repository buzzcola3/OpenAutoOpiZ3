#!/bin/sh

case "$1" in
  start)
    if [ -d /usr/share/flutter/demo/flutter_assets ] && [ -f /usr/share/flutter/demo/libapp.so ]; then
      echo "Starting flutter-pi demo"
      if command -v psplash-write >/dev/null 2>&1; then
        psplash-write "QUIT" || true
      fi
      killall psplash 2>/dev/null || true
      /usr/bin/flutter-pi --release /usr/share/flutter/demo &
    else
      echo "flutter-pi demo assets missing: /usr/share/flutter/demo/flutter_assets and /usr/share/flutter/demo/libapp.so"
    fi
    ;;
  stop)
    killall flutter-pi 2>/dev/null || true
    ;;
  restart)
    $0 stop
    $0 start
    ;;
  *)
    echo "Usage: $0 {start|stop|restart}"
    exit 1
    ;;
esac

exit 0
